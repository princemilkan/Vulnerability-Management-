# Vulnerability-Management-Lab

# Prerequisites

- A computer with internet access
- An Azure account (you can use a free subscription)
  - **Create a Free Azure Account**: [Sign up here](https://azure.microsoft.com/en-us/free/)
  - **Login**: [Azure Portal](https://portal.azure.com)

# Setting Up the Vulnerability Management Scanner

1. **Access the Marketplace**: Go to [Azure Portal](https://portal.azure.com), search for "OpenVAS secured and supported by HOSSTED."
2. **Configure VM**:
   - Choose "Start with a pre-set configuration" and select the weakest option.
   - Click "Continue to Create VM."
   - Set up the Resource Group as `Vulnerability-Management` and name the VM `OpenVAS`. Note the region and virtual network (suggest using East US 2).
   - For Authentication, use the username `azureuser` and password `Cyberlab123!`.
   - Disable Boot Diagnostics and proceed to create the VM.
3. **Access the VM**:
   - SSH into the VM using PowerShell (Windows) or Terminal (MacOS) with the credentials provided.
   - Wait for the message "Your openvas is deploying, please wait" and "hossted stage done."
   - Once done, the web app URL, default username, and password will be displayed. If you can't log in, try using `admin/admin`.
   - After logging in, change the admin password to `Cyberlab123!`.

# Creating a Client Virtual Machine and Making It Vulnerable

1. **Create VM**:
   - Navigate to [Azure Portal](https://portal.azure.com) and create a new Virtual Machine.
   - Use the Resource Group `Vulnerability-Management` and name the VM `Win10-Vulnerable`.
   - Ensure the VM is in the same region and virtual network as the OpenVAS VM.
   - Choose Windows 10 Pro as the image and any size with 2 vCPUs.
   - Set the username to `azureuser` and password `Cyberlab123!`.
   - Once the VM is created, ensure RDP access with the provided credentials.
2. **Make the VM Vulnerable**:
   - Disable the Windows Firewall.
   - Install outdated versions of software such as Firefox (97.0b5), VLC Player (vlc-1.1.7-win32), and Adobe Reader (10.0_AdbeRdr1000_en_US_1_).
   - Restart the VM.

# Configuring OpenVAS for Unauthenticated Scans

1. **Add Host**: In OpenVAS, go to `Assets` → `Hosts` → `New Host` and add the private IP address of the Client VM.
2. **Create Target**: Name it `Azure Vulnerable VMs` and take note of the credentials for later.
3. **Initiate Scan**:
   - Create a new task named `Scan - Azure Vulnerable VMs`.
   - Select the target and start the scan.
   - Review the `Last Report` and `Results` tabs for findings.

# Preparing for Credentialed Scans (VM Configuration)

1. **Adjust Settings**:
   - Disable Windows Firewall and User Account Control.
   - Enable Remote Registry and modify the registry key: `HKEY_LOCAL_MACHINE` → `SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System` → `LocalAccountTokenFilterPolicy = 1`.
   - Restart the VM.

# Preparing for Credentialed Scans (OpenVAS Configuration)

1. **Create Credentials**: Go to `Configuration` → `Credentials` → `New Credential`. Name it `Azure VM Credentials` and set `azureuser` with password `Cyberlab123!`.
2. **Clone Target**:
   - Clone the previous target, rename it to `Azure Vulnerable VMs - Credentialed Scan`.
   - Update the credentials to use `Azure VM Credentials`.

# Executing Credentialed Scan

1. **Clone and Edit Task**: Clone the previous scan task, rename it `Scan - Azure Vulnerable VMs - Credentialed`, and select the new target.
2. **Run Scan**: Start the credentialed scan and wait for it to complete. Review the `Results` for detailed findings.

# Remediation and Verification

1. **Remediate Vulnerabilities**: Log into the `Win10-Vulnerable` VM, uninstall outdated software, and restart the VM.
2. **Verify Remediations**: Rerun the `Scan - Azure Vulnerable VMs - Credentialed` and check the results to confirm that vulnerabilities have been addressed.

